{"version":3,"sources":["createToken.js"],"names":["jwt","require","signToken","id","sign","userId","process","env","SECRET_KEY","expiresIn","JWT_EXPIRES","createToken","req","res","token","cookie","expires","Date","now","JWT_COOKIE_EXPIRES_IN","httpOnly","secure","headers","sameSite","module","exports"],"mappings":";;AAAA,IAAMA,GAAG,GAAGC,OAAO,CAAC,cAAD,CAAnB;;AACA,IAAMC,SAAS,GAAG,SAAZA,SAAY,CAACC,EAAD,EAAQ;AACtB,SAAOH,GAAG,CAACI,IAAJ,CAAS;AAAEC,IAAAA,MAAM,EAAEF;AAAV,GAAT,EAAyBG,OAAO,CAACC,GAAR,CAAYC,UAArC,EAAiD;AACpDC,IAAAA,SAAS,EAAEH,OAAO,CAACC,GAAR,CAAYG;AAD6B,GAAjD,CAAP;AAGH,CAJD;;AAKA,IAAMC,WAAW,GAAG,SAAdA,WAAc,CAACR,EAAD,EAAKS,GAAL,EAAUC,GAAV,EAAkB;AAClC,MAAMC,KAAK,GAAGZ,SAAS,CAACC,EAAD,CAAvB;AACCU,EAAAA,GAAG,CAACE,MAAJ,CAAW,KAAX,EAAkBD,KAAlB,EAAyB;AACtBE,IAAAA,OAAO,EAAE,IAAIC,IAAJ,CAASA,IAAI,CAACC,GAAL,KAAaZ,OAAO,CAACC,GAAR,CAAYY,qBAAZ,GAAoC,EAApC,GAAyC,EAAzC,GAA8C,EAA9C,GAAmD,IAAzE,CADa;AAEtBC,IAAAA,QAAQ,EAAE,IAFY;AAGtBC,IAAAA,MAAM,EAAET,GAAG,CAACS,MAAJ,IAAcT,GAAG,CAACU,OAAJ,CAAY,mBAAZ,MAAqC,OAHrC;AAItBC,IAAAA,QAAQ,EAAE;AAJY,GAAzB;AAMD,SAAOT,KAAP;AACH,CATD;;AAWAU,MAAM,CAACC,OAAP,GAAiBd,WAAjB","sourcesContent":["const jwt = require('jsonwebtoken');\r\nconst signToken = (id) => {\r\n    return jwt.sign({ userId: id }, process.env.SECRET_KEY, {\r\n        expiresIn: process.env.JWT_EXPIRES\r\n    })\r\n}\r\nconst createToken = (id, req, res) => {\r\n    const token = signToken(id);\r\n     res.cookie('jwt', token, {\r\n        expires: new Date(Date.now() + process.env.JWT_COOKIE_EXPIRES_IN * 24 * 60 * 60 * 1000),\r\n        httpOnly: true,\r\n        secure: req.secure || req.headers['x-forwarded-proto'] === 'https',\r\n        sameSite: 'none',\r\n     });\r\n    return token\r\n}\r\n\r\nmodule.exports = createToken;"],"file":"createToken.dev.js"}