"use strict";var asyncHandler=require("express-async-handler"),AppError=require("../utils/AppError"),User=require("../models/user"),jwt=require("jsonwebtoken"),createToken=require("../utils/createToken");exports.signup=asyncHandler(function(r,s){var n,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(User.create({name:r.body.name,email:r.body.email,password:r.body.password,passwordConfirm:r.body.passwordConfirm}));case 2:n=e.sent,a=createToken(n._id,r,s),s.status(201).json({status:"success",token:a,data:n});case 5:case"end":return e.stop()}})}),exports.login=asyncHandler(function(r,s,n){var a,t,o,c,i;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.body,t=a.email,o=a.password,t&&o||n(new AppError(" you should enter email and password",400)),e.next=4,regeneratorRuntime.awrap(User.findOne({email:t}));case 4:if(c=e.sent,e.t0=!c,e.t0){e.next=10;break}return e.next=9,regeneratorRuntime.awrap(c.correctPassword(o,c.password));case 9:e.t0=!e.sent;case 10:if(!e.t0){e.next=12;break}n(new AppError(" Incorrect email or password",401));case 12:i=createToken(c._id,r,s),s.status(200).json({status:"success",token:i});case 14:case"end":return e.stop()}})});
//# sourceMappingURL=authController.min.js.map
