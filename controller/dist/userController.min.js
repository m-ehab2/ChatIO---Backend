"use strict";var User=require("../models/user"),asyncHandler=require("express-async-handler"),AppError=require("../utils/AppError"),mongoose=require("mongoose");exports.getUsers=asyncHandler(function(r,n){var s,t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return s=r.query.search?{$or:[{name:{$regex:r.query.search,$options:"i"}},{email:{$regex:r.query.search,$options:"i"}}]}:{},e.next=3,regeneratorRuntime.awrap(User.find(s).find({_id:{$ne:r.user._id}}));case 3:t=e.sent,n.status(200).json({status:"success",result:t.length,data:t});case 5:case"end":return e.stop()}})}),exports.getOneUser=asyncHandler(function(r,n,s){var t,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.params.id,mongoose.Types.ObjectId.isValid(t)){e.next=3;break}return e.abrupt("return",s(new AppError("Invalid user ID format",400)));case 3:return e.next=5,regeneratorRuntime.awrap(User.findById(t));case 5:if(a=e.sent){e.next=8;break}return e.abrupt("return",s(new AppError("user not found",404)));case 8:n.status(200).json({status:"success",data:a});case 9:case"end":return e.stop()}})}),exports.createUser=asyncHandler(function(r,n){var s;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(User.create({name:r.body.name,email:r.body.email,password:r.body.password,passwordConfirm:r.body.passwordConfirm}));case 2:s=e.sent,n.status(201).json({status:"success",data:s});case 4:case"end":return e.stop()}})}),exports.updateUser=asyncHandler(function(r,n,s){var t,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.params.id,mongoose.Types.ObjectId.isValid(t)){e.next=3;break}return e.abrupt("return",s(new AppError("Invalid user ID format",400)));case 3:return e.next=5,regeneratorRuntime.awrap(User.findById(t));case 5:if(e.sent){e.next=8;break}return e.abrupt("return",s(new AppError("user not found",404)));case 8:return e.next=10,regeneratorRuntime.awrap(User.findByIdAndUpdate(t,r.body,{runValidators:!0,new:!0}));case 10:a=e.sent,n.status(200).json({status:"success",data:a});case 12:case"end":return e.stop()}})}),exports.deleteUser=asyncHandler(function(r,n,s){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.params.id,mongoose.Types.ObjectId.isValid(t)){e.next=3;break}return e.abrupt("return",s(new AppError("Invalid user ID format",400)));case 3:return e.next=5,regeneratorRuntime.awrap(User.findByIdAndDelete(t));case 5:if(e.sent){e.next=8;break}return e.abrupt("return",s(new AppError("user not found",404)));case 8:return e.abrupt("return",n.status(200).json({status:"success",message:"user is deleted"}));case 9:case"end":return e.stop()}})});
//# sourceMappingURL=userController.min.js.map
