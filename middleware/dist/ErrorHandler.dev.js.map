{"version":3,"sources":["ErrorHandler.js"],"names":["AppError","require","ErrorHandler","err","req","res","next","console","log","status","statusCode","json","message","name","errorMessage","Object","values","errors","map","val","join","code","duplicateKey","keys","keyValue","originalUrl","module","exports"],"mappings":";;AAAA,IAAMA,QAAQ,GAAGC,OAAO,CAAC,mBAAD,CAAxB;;AAEA,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAACC,GAAD,EAAMC,GAAN,EAAWC,GAAX,EAAgBC,IAAhB,EAAyB;AAC1CC,EAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAqBL,GAArB;;AACA,MAAIA,GAAG,YAAYH,QAAnB,EAA6B;AACzBO,IAAAA,OAAO,CAACC,GAAR,CAAYL,GAAZ;AACAI,IAAAA,OAAO,CAACC,GAAR,CAAYR,QAAZ;AACA,WAAOK,GAAG,CAACI,MAAJ,CAAWN,GAAG,CAACO,UAAf,EAA2BC,IAA3B,CAAgC;AACnCF,MAAAA,MAAM,EAAE,MAD2B;AAEnCG,MAAAA,OAAO,EAAET,GAAG,CAACS;AAFsB,KAAhC,CAAP;AAIH;;AACD,MAAIT,GAAG,CAACU,IAAJ,KAAa,iBAAjB,EAAoC;AAChCN,IAAAA,OAAO,CAACC,GAAR,CAAYL,GAAZ;AACA,QAAMW,YAAY,GAAGC,MAAM,CAACC,MAAP,CAAcb,GAAG,CAACc,MAAlB,EAA0BC,GAA1B,CAA8B,UAAAC,GAAG;AAAA,aAAIA,GAAG,CAACP,OAAR;AAAA,KAAjC,EAAkDQ,IAAlD,CAAuD,IAAvD,CAArB;AACA,WAAOf,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBE,IAAhB,CAAqB;AACxBF,MAAAA,MAAM,EAAE,MADgB;AAExBG,MAAAA,OAAO,EAAEE;AAFe,KAArB,CAAP;AAIH;;AACD,MAAIX,GAAG,CAACU,IAAJ,KAAa,kBAAb,IAAmCV,GAAG,CAACkB,IAAJ,KAAa,KAApD,EAA2D;AACvD,QAAMC,YAAY,GAAGP,MAAM,CAACQ,IAAP,CAAYpB,GAAG,CAACqB,QAAhB,EAA0B,CAA1B,CAArB;AACA,WAAOnB,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBE,IAAhB,CAAqB;AACxBF,MAAAA,MAAM,EAAE,MADgB;AAExBG,MAAAA,OAAO,gBAASU,YAAT;AAFiB,KAArB,CAAP;AAIH;;AACD,MAAInB,GAAG,CAACU,IAAJ,KAAa,mBAAjB,EAAsC;AAClC,WAAOR,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBE,IAAhB,CAAqB;AACxBF,MAAAA,MAAM,EAAE,MADgB;AAExBG,MAAAA,OAAO,EAAE;AAFe,KAArB,CAAP;AAIH;;AACD,MAAIT,GAAG,CAACU,IAAJ,KAAa,mBAAjB,EAAsC;AAClC,WAAOR,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBE,IAAhB,CAAqB;AACxBF,MAAAA,MAAM,EAAE,MADgB;AAExBG,MAAAA,OAAO,EAAE;AAFe,KAArB,CAAP;AAIH,GApCyC,CAqC1C;;;AACA,MAAIT,GAAG,CAACM,MAAJ,KAAe,GAAnB,EAAwB;AACpB,WAAOJ,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBE,IAAhB,CAAqB;AACxBF,MAAAA,MAAM,EAAE,MADgB;AAExBG,MAAAA,OAAO,wBAAiBR,GAAG,CAACqB,WAArB;AAFiB,KAArB,CAAP;AAIH,GA3CyC,CA4C1C;;;AACA,SAAOpB,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBE,IAAhB,CAAqB;AACxBF,IAAAA,MAAM,EAAE,OADgB;AAExBG,IAAAA,OAAO,EAAE;AAFe,GAArB,CAAP;AAIH,CAjDD;;AAmDAc,MAAM,CAACC,OAAP,GAAiBzB,YAAjB","sourcesContent":["const AppError = require(\"../utils/AppError\");\r\n\r\nconst ErrorHandler = (err, req, res, next) => {\r\n    console.log(\"error \",err)\r\n    if (err instanceof AppError) {\r\n        console.log(err)\r\n        console.log(AppError)\r\n        return res.status(err.statusCode).json({\r\n            status: 'fail',\r\n            message: err.message,\r\n        });\r\n    }\r\n    if (err.name === 'ValidationError') {\r\n        console.log(err)\r\n        const errorMessage = Object.values(err.errors).map(val => val.message).join(', ');\r\n        return res.status(400).json({\r\n            status: 'fail',\r\n            message: errorMessage,\r\n        });\r\n    }\r\n    if (err.name === 'MongoServerError' && err.code === 11000) {\r\n        const duplicateKey = Object.keys(err.keyValue)[0];\r\n        return res.status(400).json({\r\n            status: 'fail',\r\n            message: `The ${duplicateKey} is already taken.`,\r\n        });\r\n    }\r\n    if (err.name === \"JsonWebTokenError\") {\r\n        return res.status(401).json({\r\n            status: 'fail',\r\n            message: \"Invalid token. Please log in again.\",\r\n        });\r\n    }\r\n    if (err.name === 'TokenExpiredError') {\r\n        return res.status(401).json({\r\n            status: 'fail',\r\n            message: \"Token is expired. Please log in again.\",\r\n        });\r\n    }\r\n    // Handle route not found error\r\n    if (err.status === 404) {\r\n        return res.status(404).json({\r\n            status: 'fail',\r\n            message: `Cannot find ${req.originalUrl} on this server.`,\r\n        });\r\n    }\r\n    // Handle other unexpected errors\r\n    return res.status(500).json({\r\n        status: 'error',\r\n        message: 'Internal server error.',\r\n    });\r\n};\r\n\r\nmodule.exports = ErrorHandler;\r\n"],"file":"ErrorHandler.dev.js"}